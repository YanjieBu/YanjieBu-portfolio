// navbar.js - 更新的导航栏脚本，支持移动端

// Sticky Navbar
window.addEventListener('scroll', stickyNavbar);
const navbar = document.querySelector('.navbar');
const stickyOffset = navbar.offsetTop;

function stickyNavbar() {
    if (window.pageYOffset >= stickyOffset) {
        navbar.classList.add("sticky");
    } else {
        navbar.classList.remove("sticky");
    }
}

// Mobile Menu Toggle
document.addEventListener('DOMContentLoaded', function() {
    const mobileToggle = document.querySelector('.mobile-menu-toggle');
    const navbarUl = document.querySelector('.navbar ul');
    
    if (mobileToggle) {
        mobileToggle.addEventListener('click', function() {
            navbarUl.classList.toggle('active');
            
            // Animate hamburger menu
            const spans = mobileToggle.querySelectorAll('span');
            if (navbarUl.classList.contains('active')) {
                spans[0].style.transform = 'rotate(45deg) translate(5px, 5px)';
                spans[1].style.opacity = '0';
                spans[2].style.transform = 'rotate(-45deg) translate(7px, -6px)';
            } else {
                spans[0].style.transform = '';
                spans[1].style.opacity = '1';
                spans[2].style.transform = '';
            }
        });
    }
    
    // Close mobile menu when clicking on a link
    const navLinks = document.querySelectorAll('.navbar ul li a');
    navLinks.forEach(link => {
        link.addEventListener('click', function() {
            if (window.innerWidth <= 768) {
                navbarUl.classList.remove('active');
                const spans = mobileToggle.querySelectorAll('span');
                spans[0].style.transform = '';
                spans[1].style.opacity = '1';
                spans[2].style.transform = '';
            }
        });
    });
    
    // Close mobile menu when clicking outside
    document.addEventListener('click', function(event) {
        if (window.innerWidth <= 768) {
            const isClickInsideNav = navbar.contains(event.target);
            if (!isClickInsideNav && navbarUl.classList.contains('active')) {
                navbarUl.classList.remove('active');
                const spans = mobileToggle.querySelectorAll('span');
                spans[0].style.transform = '';
                spans[1].style.opacity = '1';
                spans[2].style.transform = '';
            }
        }
    });
});

// Image Lightbox
document.querySelectorAll('.content img:not(.background)').forEach(img => {
    img.style.cursor = 'zoom-in';
    img.addEventListener('click', () => {
        const overlay = document.getElementById('lightbox');
        const lbImg = overlay.querySelector('img');
        lbImg.src = img.src;
        overlay.classList.add('visible');
    });
});

// Close lightbox
document.getElementById('lightbox').addEventListener('click', e => {
    if (e.target.id === 'lightbox' || e.target.tagName === 'IMG') {
        e.currentTarget.classList.remove('visible');
    }
});

// Close lightbox with Escape key
document.addEventListener('keydown', function(e) {
    if (e.key === 'Escape') {
        document.getElementById('lightbox').classList.remove('visible');
    }
});